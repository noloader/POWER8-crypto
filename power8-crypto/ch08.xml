<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<chapter id="ch09">
  <title>Performance</title>
  <indexterm>
    <primary>Performance</primary>
  </indexterm>
  <indexterm>
    <primary>Performance</primary>
    <secondary>Benchmarking</secondary>
  </indexterm>
  <para>This chapter presents benchmarking numbers and discusses some of the issues that affect performance. Benchmarking an application is an art and can be tricky to collect accurate results.</para>
  <section id="perf_powersave">
    <title>Powersave</title>
    <indexterm>
      <primary>on-demand</primary>
    </indexterm>
    <indexterm>
      <primary>powersave</primary>
    </indexterm>
    <indexterm>
      <primary>performance</primary>
    </indexterm>
    <para>Linux desktop systems are usually configured in either <systemitem>on-demand</systemitem> or <systemitem>powersave</systemitem> mode. The configuration is usually a kernel parameter, and the states are energy effcient states. Before benchmarking you should leave <systemitem>on-demand</systemitem> or <systemitem>powersave</systemitem> mode, and enter a <systemitem>performance</systemitem> state.</para>
    <indexterm>
      <primary>Cryptogams</primary>
    </indexterm>
    <indexterm>
      <primary>Andy Polyakov</primary>
    </indexterm>
    <para>Cryptogams and Andy Polyakov use a script to enter <systemitem>performance</systemitem> mode but it is not available online. A modified version of Andy's script is available at <ulink url="https://github.com/weidai11/cryptopp/blob/master/TestScripts/governor.sh"><systemitem>governor.sh</systemitem></ulink>.</para>
  </section>
  <section id="perf_comparison">
    <title>Comparison</title>
    <para>The table below presents benchmark statistics using C/C++, builtins and intrinsics, and assembly language routines. The measurements were taken on <systemitem>gcc112</systemitem>, which is a Linux PowerPC, 64-bit, little-endian machine (ppc64-le). The hardware is IBM POWER System S822 with two CPU cards. <systemitem>gcc112</systemitem> has 160 logical CPUs and runs at 3.4 GHz.</para>
    <informaltable frame="all">
      <tgroup align="center" cols="7">
        <colspec colname="c1" colwidth="1.5in"/>
        <colspec colname="c2" colwidth="0.75in"/>
        <colspec colname="c3" colwidth="0.75in"/>
        <colspec colname="c4" colwidth="0.75in"/>
        <colspec colname="c5" colwidth="0.75in"/>
        <colspec colname="c6" colwidth="0.75in"/>
        <colspec colname="c7" colwidth="0.75in"/>
        <thead>
          <row>
            <entry morerows="1" valign="middle">Algorithm</entry>
            <entry namest="c2" nameend="c3" align="center">C and C++</entry>
            <entry namest="c4" nameend="c5" align="center">Builtins</entry>
            <entry namest="c6" nameend="c7" align="center">Assembly</entry>
          </row>
          <row>
            <!-- <entry>Algorithm</entry> -->
            <entry>MiB/s</entry>
            <entry>cpb</entry>
            <entry>MiB/s</entry>
            <entry>cpb</entry>
            <entry>MiB/s</entry>
            <entry>cpb</entry>
          </row>
        </thead>
        <tbody>
          <row>
            <entry>AES/ECB</entry>
            <entry>1</entry>
            <entry>1</entry>
          </row>
          <row>
            <entry>AES/CTR</entry>
            <entry>2</entry>
            <entry>2</entry>
          </row>
          <row>
            <entry>SHA-256</entry>
            <entry>-</entry>
            <entry>-</entry>
            <entry>245</entry>
            <entry>13.3</entry>
            <entry>325</entry>
            <entry>9.9</entry>
          </row>
          <row>
            <entry>SHA-512</entry>
            <entry>-</entry>
            <entry>-</entry>
            <entry>340</entry>
            <entry>9.5</entry>
            <entry>725</entry>
            <entry>6.3</entry>
          </row>
        </tbody>
      </tgroup>
    </informaltable>
  </section>
  <section id="perf_zzz">
    <title>ZZZ</title>
    <para/>
  </section>
</chapter>
